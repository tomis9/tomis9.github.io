<!DOCTYPE html>
<html lang="en">
<head>

  <title>tomis9&#39;s cookbook</title>
  <link rel="shortcut icon" type='image/x-icon' href="https://tomis9.github.io/favicon.ico"/>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

  
  <link rel="stylesheet" href="https://tomis9.github.io/css/bootstrap-toc.css">

  
  <link rel="stylesheet" href="https://tomis9.github.io/css/darcula.css">

  
  <link rel="stylesheet" href="https://tomis9.github.io/css/style.css">

  
  <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet">        
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css?family=Fascinate&display=swap" rel="stylesheet">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">

</head>


<body data-spy="scroll" data-target="#toc">



<nav id="navbar" class="navbar navbar-expand-md fixed-top navbar-hide transition">

  
  <a class="navbar-brand"></a>

  <button class="navbar-toggler float-xs-right" data-toggle="collapse" data-target="#collapsibleNavbar">
    Menu
  </button>

  <div class="collapse navbar-collapse" id="collapsibleNavbar">

    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://tomis9.github.io">Home</a>
      </li>
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Python</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/airflow/">airflow</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/beautiful_soup/">beautiful soup</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/decorators/">decorators</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/flask/">flask</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/learning_tensorflow/">learning tensorflow</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pyenv/">pyenv, virtualenv, freeze</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pytorch/">pytorch</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/sqlalchemy/">sqlAlchemy</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/tensorflow/">tensorflow</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/testing/">testing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">R</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/cinr/">C in R</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/rmariadb/">RMariaDB (former RMySQL)</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/rcpp/">Rcpp</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/classess4/">classes - S4</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/data.table/">data.table</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/debugging/">debugging</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/decision_trees/">decision trees</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/ggplot2/">ggplot2</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/lubridate/">lubridate</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/nls/">nls</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/packages/">packages</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/rtags/">rTags</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/reshape2/">reshape2</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/rocker/">rocker</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/rstanarm/">rstanarm</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/shiny/">shiny</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/sqldf/">sqldf</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/tidyverse/">tidyverse</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Data engineering</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/airflow/">airflow</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/hadoop/">hadoop</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/logging/">logging</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/spark/">spark</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/useful_processing/">useful processing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Machine learning</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/ml/">basic machine learning algorithms</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/decision_trees/">decision trees</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/learning_tensorflow/">learning tensorflow</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/validation/">model validation</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/nls/">nls</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pytorch/">pytorch</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/tensorflow/">tensorflow</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/useful_processing/">useful processing</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">DevOps</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/docker/">docker</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/flask/">flask</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/git/">git</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/heroku/">heroku</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/mesos/">mesos</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pyenv/">pyenv, virtualenv, freeze</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/rocker/">rocker</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/testing/">testing</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/vagrant/">vagrant</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">Projects</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/vim_vs_emacs/">vim vs emacs - text mining to settle the editor war</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/cookbook/">writing a cookbook</a>
          
        </div>
      </li>
    
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" data-toggle="dropdown">scratchpad</a>
        <div class="dropdown-menu scrollable-menu">
          
            <a class="dropdown-item" href="https://tomis9.github.io/hugo/">Hugo</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/file/">Rmarkdown total basics</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/caffee/">caffee</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/cassandra/">cassandra</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/featuretools/">featuretools</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/gitlab_ci/">gitlab-ci</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/kafka/">kafka</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/marathon/">marathon</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/nlp/">nlp</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/pandas/">pandas</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/passing_arguments/">passing arguments to scripts</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/redis/">redis</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/tensorflow_serving/">tensorflow_serving</a>
          
            <a class="dropdown-item" href="https://tomis9.github.io/theano/">theano</a>
          
        </div>
      </li>
    
    </ul>

  </div>  

</nav>



<div class="jumbotron text-center" id="header">

  <div id="header-title">
      <a href="https://tomis9.github.io">tomis9&#39;s cookbook</a>
  </div>

  <p style="color: white;">data science tutorials and snippets prepared by tomis9</p> 

</div>


<nav id="toc" data-toggle="toc" class="sticky-top d-none d-xl-block"></nav>

<div class="article">

<div class="article-categories">
  
    <object style="vertical-align:middle" type="image/svg+xml" data="/folder.svg" height="15px" width="15px"></object> 
    <a href="https://tomis9.github.io/categories/python" role="button">Python </a>
    &emsp;
  
    <object style="vertical-align:middle" type="image/svg+xml" data="/folder.svg" height="15px" width="15px"></object> 
    <a href="https://tomis9.github.io/categories/machine-learning" role="button">Machine learning </a>
    &emsp;
  </br>
</div>
<div class="article-title">
  
  pytorch

</div>
<div class="article-info">
    Jan 6, 2019 &emsp;  &emsp; 7 minutes read
</div>




<div id="what-is-pytorch-and-why-would-you-use-it" class="section level2">
<h2>1. What is <code>pytorch</code> and why would you use it?</h2>
<ul>
<li><p>pytorch is a python package which makes learning deep neaural networks relatively easy and fast</p></li>
<li><p>it’s main “rival” is tensorflow, as pytorch was released by Facebook, but tensorflow by Google</p></li>
</ul>
</div>
<div id="hello-world-example" class="section level2">
<h2>2. “Hello world” example</h2>
<blockquote>
<p>inspired by <a href="https://towardsdatascience.com/pytorch-vs-tensorflow-spotting-the-difference-25c75777377b">this article</a></p>
</blockquote>
<p>Let’s define some data:</p>
<pre class="python"><code>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt


theta = 2
x = np.random.rand(10) * 10
y = x ** theta
data = pd.DataFrame(dict(x=x, y=y))
print(data)</code></pre>
<pre><code>##           x          y
## 0  8.520089  72.591910
## 1  8.610977  74.148918
## 2  4.796133  23.002888
## 3  9.971878  99.438360
## 4  7.678634  58.961420
## 5  7.072061  50.014045
## 6  5.995141  35.941718
## 7  4.744001  22.505545
## 8  4.623789  21.379420
## 9  3.899390  15.205244</code></pre>
<pre class="python"><code>plt.figure(1)
plt.scatter(x, y)
plt.show()</code></pre>
<p><img src="https://tomis9.github.io/pytorch_files/figure-html/unnamed-chunk-1-1.png" /><!-- --></p>
<p><code>theta</code> is a parameter we’ll be estimating. We will see how close to 2 our optimization algorithm gets us.</p>
<p>Estimating the value of theta:</p>
<pre class="python"><code>import torch
from torch.autograd import Variable


def rmse(y, y_hat):
    &quot;&quot;&quot;Compute root mean squared error&quot;&quot;&quot;
    return torch.sqrt(torch.mean((y - y_hat).pow(2).sum()))


def forward(x, e):
    &quot;&quot;&quot;Forward pass for our fuction&quot;&quot;&quot;
    return x.pow(e.repeat(x.size(0)))

# initial settings
learning_rate = 0.00005

x = Variable(torch.FloatTensor(data[&#39;x&#39;]), requires_grad=False)
y = Variable(torch.FloatTensor(data[&#39;y&#39;]), requires_grad=False)

# should be a random value, but don&#39;t know how to set seed in pytorch
theta_hat = Variable(torch.FloatTensor([1]), requires_grad=True)

loss_history = []
theta_history = []

for i in range(0, 600):
    y_hat = forward(x, theta_hat)
    loss = rmse(y, y_hat)
    loss_history.append(loss.data.item())
    loss.backward()

    theta_hat.data -= learning_rate * theta_hat.grad.data
    theta_hat.grad.data.zero_()
    theta_history.append(theta_hat.data.item())</code></pre>
<pre><code>## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])
## tensor([0.])</code></pre>
<p>And the estimation is…</p>
<pre class="python"><code>print(theta_hat.data)</code></pre>
<pre><code>## tensor([2.0092])</code></pre>
<p>Not bad! Let’s see how the process of learning looked:</p>
<pre class="python"><code>plt.figure(2)
plt.scatter(x=range(len(loss_history)), y=loss_history)
plt.title(&quot;Loss history&quot;)
plt.show()</code></pre>
<p><img src="https://tomis9.github.io/pytorch_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
<pre class="python"><code>plt.figure(3)
plt.scatter(x=range(len(theta_history)), y=theta_history)
plt.title(&quot;Theta history&quot;)
plt.show()</code></pre>
<p><img src="https://tomis9.github.io/pytorch_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
<p>Pytorch reached the correct estimation in about 200 iterations.</p>
</div>

</div>

<div class="jumbotron text-center" id="footer">

  made using &emsp;
  <br class="d-xl-none">
  <a href="https://gohugo.io/">Hugo</a> |
  <a href="https://getbootstrap.com/">Bootstrap</a> |
  <a href="https://highlightjs.org/">highlightjs</a> |
  <a href="https://bookdown.org/yihui/blogdown/">blogdown</a> |
  <a href="https://fonts.google.com/">Google fonts</a> &emsp;
  <br class="d-xl-none">
  <a href="https://github.com/tomis9/cookbook">github</a> |
  <a href="https://travis-ci.org/tomis9/cookbook">travis-ci</a> <a href="https://travis-ci.org/tomis9/cookbook"><img src="https://api.travis-ci.org/tomis9/cookbook.png"></img></a> |
  <a href="https://hub.docker.com/r/tomis9/cookbook">docker hub</a> &emsp;
  <br class="d-xl-none">
  <a href="https://aws.amazon.com/s3">Amazon S3</a> |
  <a href="https://aws.amazon.com/route53/">Amazon Route 53</a> &emsp;
  <br class="d-xl-none">
  Copyright &copy; 2019 tomis9

</div>

</body>



<script src="https://tomis9.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


<script src="https://tomis9.github.io/js/bootstrap-toc.js"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>


<script>
$(window).scroll(function() {
  
  if ($(window).scrollTop() > 100 ) {
    $('.navbar').removeClass('navbar-hide');
    $('.navbar').addClass('navbar-show');
  } else {
    $('.navbar').removeClass('navbar-show');
    $('.navbar').addClass('navbar-hide');
  };   	
});
</script>

</html>

